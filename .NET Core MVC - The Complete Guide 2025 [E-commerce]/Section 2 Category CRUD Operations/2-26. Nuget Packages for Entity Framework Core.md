![[{92DDBE9D-0BCC-49F2-8843-2DF4D45AF776}.png]]

![[{F2DF8DE2-68B8-40CE-8E3E-BFB81FBFD8E9}.png]]
![[{03D4C3B2-43E8-4F0E-9AF9-D4548D5B0EB0}.png]]
## Bài học: Cài đặt và Cấu hình Entity Framework Core để Tạo Cơ sở Dữ liệu

### Khái niệm về Entity Framework Core
- **Entity Framework Core** (Khung thực thể cốt lõi): Là một framework trong .NET cho phép quản lý cơ sở dữ liệu trực tiếp từ mã nguồn, thay vì sử dụng các câu lệnh SQL thủ công.
- Sử dụng Entity Framework Core để:
  - Tạo cơ sở dữ liệu và bảng từ các model trong mã nguồn.
  - Thực hiện các thao tác CRUD (Tạo, Đọc, Cập nhật, Xóa) thông qua mã C#.

### Chuẩn bị cài đặt
- Trong các phiên bản .NET hiện đại (như .NET 8), Entity Framework Core không được bao gồm mặc định trong dự án. Cần cài đặt các gói NuGet tương ứng.
- Các gói NuGet cần thiết:
  - `Microsoft.EntityFrameworkCore`: Gói chính của Entity Framework Core.
  - `Microsoft.EntityFrameworkCore.SqlServer`: Gói hỗ trợ kết nối với SQL Server.
  - `Microsoft.EntityFrameworkCore.Tools`: Gói cung cấp công cụ dòng lệnh để thực hiện migration (di chuyển cơ sở dữ liệu).

### Hướng dẫn cài đặt gói NuGet
1. **Mở công cụ quản lý NuGet**:
   - Trong Visual Studio, nhấp chuột phải vào dự án (ví dụ: `BulkyWeb`) và chọn **Manage NuGet Packages**.
2. **Cài đặt các gói cần thiết**:
   - Tìm và cài đặt các gói sau:
     - `Microsoft.EntityFrameworkCore`
     - `Microsoft.EntityFrameworkCore.SqlServer`
     - `Microsoft.EntityFrameworkCore.Tools`
   - Nếu sử dụng .NET 8 (preview), bật tùy chọn **Include prerelease** để cài đặt phiên bản preview.
   - Đảm bảo tất cả các gói có cùng phiên bản (ví dụ: 8.0.0-preview) để tránh xung đột.

3. **Kiểm tra cài đặt**:
   - Sau khi cài đặt, các gói sẽ được thêm vào tệp dự án (`.csproj`) dưới dạng `<PackageReference>`.
   - Ví dụ nội dung tệp `.csproj`:
     ```xml
     <ItemGroup>
         <PackageReference Include="Microsoft.EntityFrameworkCore" Version="8.0.0-preview" />
         <PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer" Version="8.0.0-preview" />
         <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="8.0.0-preview" />
     </ItemGroup>
     ```

4. **Cập nhật gói**:
   - Nếu có phiên bản mới hơn, sử dụng tab **Updates** trong NuGet Package Manager để cập nhật tất cả các gói cùng lúc, đảm bảo đồng bộ phiên bản.

### Vai trò của Migration
- **Migration** (Di chuyển): Là quá trình Entity Framework Core sử dụng để tạo hoặc cập nhật cấu trúc cơ sở dữ liệu dựa trên các model trong mã nguồn.
- Gói `Microsoft.EntityFrameworkCore.Tools` cung cấp các lệnh dòng lệnh (như `Add-Migration` và `Update-Database`) để thực hiện migration.
- Chi tiết về migration sẽ được giải thích trong các bài học tiếp theo.

### Lưu ý quan trọng
- Đảm bảo tất cả các gói NuGet của Microsoft đều có cùng phiên bản để tránh lỗi tương thích.
- Các gói NuGet được thêm vào tệp dự án (`.csproj`) tự động khi cài đặt qua NuGet Package Manager.
- Nếu một phiên bản mới của .NET (như preview 2 hoặc 9 của .NET 8) được phát hành, bạn có thể chọn cài đặt phiên bản cụ thể thay vì phiên bản mới nhất.

### Các bước tiếp theo
- Sau khi cài đặt các gói NuGet, cần cấu hình Entity Framework Core trong `Program.cs` để sử dụng chuỗi kết nối từ `appsettings.json` và tạo cơ sở dữ liệu.
- Quá trình này sẽ được hướng dẫn chi tiết trong các bài học tiếp theo.

### Liên kết nội bộ
- [[Entity Framework Core]]
- [[Chuỗi kết nối (Connection String)]]
- [[appsettings.json]]
- [[Migration]]
- [[NuGet Package]]