## Sử Dụng Partial View để Hiển Thị Thông Báo TempData

### Mục tiêu
- Tái sử dụng mã hiển thị thông báo `TempData` trên nhiều trang trong ứng dụng (ví dụ: các trang quản lý danh mục, loại bìa sản phẩm, sản phẩm).
- Tạo một partial view để hiển thị thông báo thành công (`Success`) và lỗi (`Error`), tránh lặp lại mã trong nhiều view.
- Đảm bảo dễ dàng bảo trì và cập nhật giao diện thông báo.

### Khái niệm Partial View
- **Partial View**: Là một tệp view nhỏ trong ASP.NET Core, được nhúng vào các view khác để tái sử dụng mã HTML/Razor.
  - Thường được đặt trong thư mục `Shared` và có tiền tố `_` trong tên tệp (ví dụ: `_Notification.cshtml`) để dễ nhận biết.
  - Giúp giảm thiểu việc lặp lại mã và tập trung hóa logic hiển thị cho các thành phần tái sử dụng.
- **Ứng dụng**: Sử dụng partial view để hiển thị thông báo `TempData` (thành công hoặc lỗi) trên nhiều trang.

### Quy trình thực hiện
#### 1. Tạo Partial View cho Thông Báo
- **Vị trí**: Thêm partial view trong thư mục `Views/Shared`.
- **Thực hiện**:
  - Nhấp chuột phải vào thư mục `Shared`, chọn "Add" > "View", tạo một empty view với tên `_Notification.cshtml`.
  - Di chuyển logic hiển thị thông báo `TempData` từ view `Index.cshtml` vào partial view `_Notification.cshtml`.
  - Thêm logic để hiển thị cả thông báo thành công (`TempData["Success"]`) và lỗi (`TempData["Error"]`).

#### 2. Cập nhật View Index để Nhúng Partial View
- **Thực hiện**:
  - Trong `Index.cshtml`, xóa đoạn mã hiển thị thông báo trực tiếp.
  - Nhúng partial view `_Notification.cshtml` bằng thẻ `<partial>` với thuộc tính `name`.
  - Đảm bảo tên partial view được viết chính xác (bao gồm `_` và `.cshtml`).

#### 3. Kiểm Tra Chức Năng
- **Thực hiện**:
  - Chạy ứng dụng và thực hiện các thao tác CRUD (ví dụ: tạo, chỉnh sửa, xóa danh mục).
  - Kiểm tra xem thông báo thành công (`Category updated successfully`) có hiển thị đúng trên trang `Index`.
  - Xác nhận rằng việc tải lại trang (refresh) sẽ làm thông báo biến mất do đặc tính của `TempData`.
  - Lưu ý: Thông báo lỗi (`TempData["Error"]`) chưa được triển khai trong controller, nhưng partial view đã sẵn sàng để xử lý nếu cần.

### Mã nguồn
#### Partial View `_Notification.cshtml`
```html
@if (TempData["Success"] != null)
{
    <h2>@TempData["Success"]</h2>
}
@if (TempData["Error"] != null)
{
    <h2>@TempData["Error"]</h2>
}
```

#### View Index.cshtml (Cập nhật để nhúng Partial View)
```html
@model IEnumerable<Category>

<partial name="_Notification" />

<table class="table">
    <thead>
        <tr>
            <th>Tên Danh Mục</th>
            <th>Thứ Tự Hiển Thị</th>
            <th>Hành Động</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.Name</td>
                <td>@item.DisplayOrder</td>
                <td>
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-primary">Sửa</a>
                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-danger">Xóa</a>
                </td>
            </tr>
        }
    </tbody>
</table>
```

### Ghi chú thêm
- **Lợi ích của Partial View**:
  - **Tái sử dụng**: Chỉ cần viết mã hiển thị thông báo một lần trong `_Notification.cshtml`, sau đó nhúng vào bất kỳ view nào cần.
  - **Dễ bảo trì**: Nếu cần thay đổi giao diện hoặc logic hiển thị thông báo (ví dụ: dùng `<div class="alert">` thay vì `<h2>`), chỉ cần chỉnh sửa trong `_Notification.cshtml`, và tất cả các view sử dụng partial view sẽ tự động cập nhật.
- **Thông báo lỗi (`TempData["Error"]`)**:
  - Hiện tại, controller chưa gán giá trị cho `TempData["Error"]`, nhưng partial view đã được thiết kế để hỗ trợ hiển thị thông báo lỗi nếu cần.
  - Có thể thêm logic lỗi trong các action method (ví dụ: khi `ModelState` không hợp lệ hoặc danh mục không tồn tại).
- **Tên Partial View**:
  - Tiền tố `_` trong tên tệp (như `_Notification.cshtml`) là quy ước để nhận biết partial view, không bắt buộc nhưng nên tuân theo.
  - Đảm bảo tên trong thẻ `<partial>` khớp chính xác với tên tệp (bao gồm `_`).

### Liên kết liên quan
- [[TempData trong ASP.NET Core]]
- [[Partial View trong ASP.NET Core]]
- [[Quản lý danh mục]]
- [[Action Method trong ASP.NET]]