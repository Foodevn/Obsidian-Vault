## Truyền dữ liệu từ Controller sang View và hiển thị danh sách

Bài học này hướng dẫn cách lấy một danh sách dữ liệu từ [[Controller]] và hiển thị nó trên [[View]] trong [[ASP.NET Core MVC]].

### ### Luồng hoạt động cơ bản

- **[[Controller]]**: Chứa các phương thức hành động (action methods) được gọi khi có yêu cầu (request). Nhiệm vụ của nó là xử lý logic, truy vấn dữ liệu từ [[Model]].
- **[[View]]**: Chứa mã giao diện người dùng (HTML, CSS). Nó nhận dữ liệu từ Controller để hiển thị.
- **[[Model]]**: Đại diện cho dữ liệu của ứng dụng (ví dụ: lớp `Category`).

### ### Cách thực hiện

#### 1. Truyền dữ liệu từ Controller sang View

Để truyền dữ liệu từ một phương thức hành động (action method) trong Controller tới View tương ứng, bạn chỉ cần truyền đối tượng dữ liệu đó làm tham số cho phương thức `View()`.

- Trong ví dụ này, chúng ta có một danh sách các đối tượng `Category` (`List<Category>`).
- Chúng ta truyền trực tiếp danh sách này vào `View(categoryList)`.

```csharp
// Trong Controller
public IActionResult Index()
{
    List<Category> categoryList = _db.Categories.ToList();
    return View(categoryList); 
}
```

#### 2. Nhận và định nghĩa Model trong View

Để View có thể nhận và hiểu được kiểu dữ liệu được truyền sang, chúng ta cần khai báo [[Model]] ở đầu file `.cshtml` bằng chỉ thị `@model` (lưu ý: viết thường).

- Cú pháp: `@model <Kiểu dữ liệu>`
- Ví dụ: `@model List<Category>`
- Khai báo này cho View biết rằng nó sẽ làm việc với một đối tượng là danh sách các `Category`.

```csharp
@* File: Views/Category/Index.cshtml *@
@model List<Category>
```

#### 3. Hiển thị dữ liệu bằng vòng lặp trong View

[[ASP.NET Core MVC]] sử dụng cú pháp Razor, cho phép viết mã C# trực tiếp trong file HTML bằng cách sử dụng ký tự `@`.

- **Truy cập dữ liệu**: Để truy cập đối tượng model đã được truyền sang, ta dùng `@Model` (lưu ý: viết hoa chữ M theo kiểu Pascal).
- **Duyệt danh sách**: Sử dụng vòng lặp `@foreach` để duyệt qua từng phần tử trong `@Model`.
- **Hiển thị thuộc tính**: Bên trong vòng lặp, dùng cú pháp `@obj.PropertyName` để truy cập và hiển thị các thuộc tính của đối tượng (ví dụ: `@obj.Name`, `@obj.DisplayOrder`).

### ### Mã nguồn ví dụ (View)

```csharp name=Views/Category/Index.cshtml
@model List<Category>

<div class="container">
    <div class="row pt-4">
        <div class="col-6">
            <h2 class="text-primary">
                Category List
            </h2>
        </div>
    </div>
    <br />

    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>
                    Category Name
                </th>
                <th>
                    Display Order
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var obj in Model.OrderBy(u => u.DisplayOrder))
            {
                <tr>
                    <td>@obj.Name</td>
                    <td>@obj.DisplayOrder</td>
                </tr>
            }
        </tbody>
    </table>
</div>
```

	### ### Ghi chú thêm

- **Phân biệt `@model` và `@Model`**:
  - `@model` (viết thường): Dùng để **khai báo** kiểu dữ liệu mà View sẽ nhận ở đầu trang.
  - `@Model` (viết hoa): Dùng để **truy cập** vào đối tượng dữ liệu đã được truyền từ Controller.
- **Tải lại nóng (Hot Reload)**: Tính năng này giúp cập nhật giao diện trên trình duyệt ngay lập tức sau khi bạn lưu thay đổi trong mã nguồn mà không cần phải biên dịch lại toàn bộ dự án.
- **Sử dụng LINQ trong View**: Bạn có thể thực hiện các truy vấn LINQ đơn giản trực tiếp trên `@Model` trong View, ví dụ như sắp xếp (`.OrderBy()`). Điều này cho thấy sự linh hoạt của Razor.
