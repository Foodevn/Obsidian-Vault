## Tích Hợp Toastr Notification vào Ứng Dụng ASP.NET Core

### Mục tiêu
- Thay thế thẻ `<h2>` đơn giản bằng thông báo Toastr (một thư viện JavaScript) để hiển thị thông báo thành công (`Success`) và lỗi (`Error`) một cách sinh động và chuyên nghiệp.
- Tích hợp Toastr vào partial view `_Notification.cshtml` và nhúng partial view vào layout chính (`_Layout.cshtml`) để sử dụng trên toàn bộ ứng dụng.
- Đảm bảo mã dễ bảo trì và tránh lặp lại trên nhiều trang.

### Khái niệm Toastr
- **Toastr**: Là một thư viện JavaScript dùng để hiển thị thông báo dạng popup (toast) với giao diện đẹp, hỗ trợ các loại thông báo như `success`, `error`, `warning`, và `info`.
  - Trang chính thức: [Toastr](https://codeseven.github.io/toastr/)
  - Yêu cầu: Cần bao gồm tệp CSS và JavaScript của Toastr, cùng với jQuery (đã có sẵn trong dự án).
- **Lợi ích**:
  - Giao diện thông báo trực quan, hiện đại hơn so với thẻ `<h2>`.
  - Dễ dàng tích hợp và tùy chỉnh.
  - Có thể sử dụng trên toàn ứng dụng thông qua partial view và layout.

### Quy trình thực hiện
#### 1. Thêm Toastr CSS và JavaScript
- **Thêm CSS**:
  - Sao chép CDN của Toastr CSS (phiên bản minified) và thêm vào tệp `_Layout.cshtml` trong phần `<head>` để áp dụng kiểu dáng toàn cục.
- **Thêm JavaScript**:
  - Sao chép CDN của Toastr JavaScript (phiên bản minified) và thêm vào partial view `_Notification.cshtml` để gọi hàm `toastr` khi hiển thị thông báo.
  - Đảm bảo jQuery đã được bao gồm trong dự án (thường nằm trong thư mục `lib/jquery/dist/jquery.min.js`).

#### 2. Cập nhật Partial View `_Notification.cshtml`
- Thay thế thẻ `<h2>` bằng lệnh gọi `toastr.success` hoặc `toastr.error` để hiển thị thông báo.
- Đặt mã JavaScript trong thẻ `<script>` với thuộc tính `type="text/javascript"`.

#### 3. Nhúng Partial View vào Layout
- Di chuyển thẻ `<partial name="_Notification">` từ `Index.cshtml` sang `_Layout.cshtml`, đặt trước `@RenderBody()` để áp dụng thông báo trên toàn bộ các trang.
- Điều này đảm bảo mọi trang trong ứng dụng đều có thể hiển thị thông báo Toastr mà không cần nhúng partial view riêng lẻ.

#### 4. Kiểm Tra Chức Năng
- Chạy ứng dụng và thực hiện các thao tác CRUD (tạo, chỉnh sửa, xóa danh mục).
- Kiểm tra xem thông báo Toastr có hiển thị đúng (ví dụ: "Category updated successfully" khi chỉnh sửa) và có biến mất khi tải lại trang.
- Xác nhận rằng thông báo hoạt động trên mọi trang nhờ tích hợp trong `_Layout.cshtml`.

### Mã nguồn
#### _Layout.cshtml (Thêm Toastr CSS)
```html
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - YourAppName</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
    <!-- Các liên kết CSS khác -->
</head>
<body>
    <partial name="_Notification" />
    @RenderBody()
    <!-- Các script khác -->
</body>
```

#### _Notification.cshtml (Cập nhật với Toastr)
```html
@if (TempData["Success"] != null)
{
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script type="text/javascript">
        toastr.success("@TempData["Success"]");
    </script>
}
@if (TempData["Error"] != null)
{
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script type="text/javascript">
        toastr.error("@TempData["Error"]");
    </script>
}
```

#### Controller (Không thay đổi)
- Các action method `Create`, `EditPost`, và `DeletePost` vẫn giữ nguyên logic gán `TempData["Success"]` như trong ghi chú trước.
- Nếu cần thông báo lỗi, có thể thêm `TempData["Error"]` trong các trường hợp thất bại (ví dụ: khi `ModelState` không hợp lệ).

### Ghi chú thêm
- **Lợi ích của Toastr**:
  - Cung cấp giao diện thông báo hiện đại, tự động ẩn sau vài giây.
  - Hỗ trợ nhiều loại thông báo (`success`, `error`, `warning`, `info`) với tùy chỉnh dễ dàng.
- **Tái sử dụng qua Layout**:
  - Việc nhúng `_Notification.cshtml` vào `_Layout.cshtml` giúp thông báo Toastr khả dụng trên mọi trang mà không cần thêm mã lặp lại.
  - Nếu cần thay đổi thư viện thông báo (ví dụ: từ Toastr sang một thư viện khác), chỉ cần cập nhật `_Notification.cshtml` thay vì chỉnh sửa từng view.
- **Tối ưu hóa**:
  - Sử dụng phiên bản minified của Toastr CSS và JavaScript để giảm thời gian tải, phù hợp cho môi trường production.
  - Đảm bảo jQuery được bao gồm trước Toastr vì Toastr phụ thuộc vào jQuery.
- **Thông báo lỗi (`TempData["Error"]`)**:
  - Hiện tại, controller chưa gán giá trị cho `TempData["Error"]`, nhưng partial view đã sẵn sàng để hiển thị nếu được triển khai trong tương lai.

### Kiểm tra chức năng
- **Chỉnh sửa danh mục**:
  - Sửa thứ tự hiển thị của danh mục (ví dụ: từ 88 thành 99).
  - Kiểm tra thông báo Toastr hiển thị: "Category updated successfully".
- **Xóa danh mục**:
  - Xóa một danh mục và xác nhận thông báo Toastr: "Category deleted successfully".
- **Tải lại trang**: Thông báo Toastr biến mất sau khi refresh, phù hợp với đặc tính của `TempData`.
- **Kiểm tra trên các trang khác**: Vì partial view được nhúng trong `_Layout.cshtml`, thông báo sẽ hoạt động trên mọi trang trong ứng dụng.

### Liên kết liên quan
- [[TempData trong ASP.NET Core]]
- [[Partial View trong ASP.NET Core]]
- [[Toastr Notification]]
- [[Quản lý danh mục]]
- [[Layout trong ASP.NET Core]]