## Bài học: Cấu hình Chuỗi Kết nối (Connection String) trong Dự án

### Khái niệm về Chuỗi Kết nối
- **Chuỗi kết nối** (Connection String): Là một chuỗi chứa thông tin cần thiết để kết nối ứng dụng với cơ sở dữ liệu (SQL Server).
- Các thành phần chính của chuỗi kết nối:
  - **Server**: Tên máy chủ SQL (ví dụ: `localhost`, `.`, hoặc `(localdb)\MSSQLLocalDB`).
  - **Database**: Tên cơ sở dữ liệu.
  - **Trusted_Connection**: Xác thực Windows.
  - **TrustServerCertificate**: Bỏ qua kiểm tra chứng chỉ máy chủ.

### Yêu cầu cài đặt
- Cần cài đặt:
  - **SQL Server**: Phần mềm cơ sở dữ liệu.
  - **SQL Server Management Studio (SSMS)**: Công cụ quản lý cơ sở dữ liệu.
- Kiểm tra kết nối trong SSMS:
  - Sử dụng `localhost`, `.`, hoặc `(localdb)\MSSQLLocalDB` để kết nối với máy chủ cục bộ.
  - Nếu kết nối thành công, bạn có thể sử dụng thông tin máy chủ này trong chuỗi kết nối.

### Thêm Chuỗi Kết nối vào Dự án
- **Vị trí lưu trữ**: Chuỗi kết nối được lưu trong tệp `appsettings.json`, không nên mã hóa cứng trong `Program.cs`.
- **Cấu trúc tệp `appsettings.json`**:
  - Sử dụng khóa `ConnectionStrings` để lưu trữ chuỗi kết nối.
  - Bên trong `ConnectionStrings`, định nghĩa một cặp khóa-giá trị với tên tùy ý (thường là `DefaultConnection`).

### Ví dụ: Thêm Chuỗi Kết nối
1. Mở tệp `appsettings.json`.
2. Thêm đoạn mã sau:
   ```json
   {
     "ConnectionStrings": {
       "DefaultConnection": "Server=.;Database=Bulky;Trusted_Connection=True;TrustServerCertificate=True"
     }
   }
   ```
3. **Giải thích các thành phần**:
   - `Server=.;`: Máy chủ cục bộ (dấu chấm biểu thị máy chủ mặc định).
   - `Database=Bulky;`: Tên cơ sở dữ liệu là `Bulky`.
   - `Trusted_Connection=True;`: Sử dụng xác thực Windows.
   - `TrustServerCertificate=True;`: Bỏ qua kiểm tra chứng chỉ để đảm bảo kết nối thành công.

### Lưu ý quan trọng
- Tên khóa `ConnectionStrings` phải chính xác (phân biệt chữ hoa/thường) vì đây là quy ước chuẩn của .NET.
- Tên `DefaultConnection` là tùy ý, nhưng nên sử dụng để dễ quản lý.
- Đảm bảo không có lỗi chính tả:
  - `Trusted_Connection` có dấu gạch dưới.
  - `TrustServerCertificate` không có dấu gạch dưới hoặc khoảng trắng.
- Nếu không đặt `TrustServerCertificate=True`, kết nối có thể thất bại do yêu cầu chứng chỉ từ SQL Server.

### Các bước tiếp theo
- Sau khi định nghĩa chuỗi kết nối, cần cấu hình ứng dụng để sử dụng **Entity Framework Core** và kết nối với cơ sở dữ liệu.
- Quá trình này sẽ được giải thích chi tiết trong các bài học tiếp theo, bao gồm cách sử dụng chuỗi kết nối để tạo bảng.

### Ghi chú thêm
- Kiểm tra kết nối SQL Server trong SSMS trước khi cấu hình trong dự án.
- Lý do sử dụng tên `ConnectionStrings` sẽ được giải thích khi các thành phần của ứng dụng được kết hợp.

### Liên kết nội bộ
- [[Chuỗi kết nối (Connection String)]]
- [[Entity Framework Core]]
- [[appsettings.json]]
- [[SQL Server Management Studio]]